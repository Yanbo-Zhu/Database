
**æ³¨æ„ï¼Œè¡¨åå’Œè¡¨å­—æ®µä½¿ç”¨ä¸‹åˆ’çº¿æ–¹å¼å‘½åï¼Œä¸è¦ç”¨é©¼å³°ï¼Œä¸ç„¶æ˜ å°„åˆ°Java ä¼šæŠ¥æ‰¾ä¸åˆ°è¡¨çš„é”™**


# 1 æ•°æ®ç±»å‹ 


# 2 CHARACTER VARYING(255) or VARCHAR(255) 

CHARACTER VARYING(255) (or VARCHAR(255)) â†’ A variable-length string with a maximum length of 255 characters.



## 2.1 BIGINT/`INTEGER`/`BIGINT`

| Type               | Storage Size | Range                                                       |
| ------------------ | ------------ | ----------------------------------------------------------- |
| `SMALLINT`         | 2 bytes      | `-32,768` to `32,767`                                       |
| `INTEGER` (`INT4`) | 4 bytes      | `-2,147,483,648` to `2,147,483,647`                         |
| `BIGINT` (`INT8`)  | 8 bytes      | `-9,223,372,036,854,775,808` to `9,223,372,036,854,775,807` |



ä¸æ˜¯çš„è‡ªå¢å­—æ®µ


```java
ALTER TABLE public.kss_user_pay 
    ALTER COLUMN myid 
    SET DATA TYPE BIGINT;  -- ç¡®ä¿æ•°æ®ç±»å‹æ­£ç¡®

ALTER TABLE public.kss_user_pay 
    ALTER COLUMN myid 
    SET DEFAULT nextval('public.kss_user_pay_id_seq');
```


## 2.2 SMALLSERIAL/SERIAL/BIGSERIAL: (å¯ä»¥è‡ªå¢çš„æ•°æ®ç±»å‹)

2/4/6 Bytes 

PostgreSQL æä¾› `SERIAL` ç±»å‹ï¼Œå®ƒä¼šè‡ªåŠ¨åˆ›å»º **åºåˆ—** å¹¶ç»‘å®šåˆ°å­—æ®µ
- `BIGSERIAL` is an **auto-incrementing BIGINT** (hidden sequence).
- This is the **recommended** way to define an auto-incrementing `BIGINT` primary key.

```sql
CREATE TABLE users (
    id BIGSERIAL PRIMARY KEY,  -- Auto-incrementing BIGINT
    name VARCHAR(255)
);
```



## 2.3 UUID

UUIDï¼ˆUniversally Unique Identifierï¼‰ æ˜¯ 128 ä½ çš„æ ‡è¯†ç¬¦ï¼Œé€šå¸¸ç”¨æ¥ç¡®ä¿å…¨å±€å”¯ä¸€æ€§ã€‚
åœ¨ PostgreSQL ä¸­ï¼ŒUUID çš„é»˜è®¤æ ¼å¼ä¸ºï¼š `550e8400-e29b-41d4-a716-446655440000` ï¼ˆåŒ…å« **32 ä¸ªåå…­è¿›åˆ¶å­—ç¬¦ + 4 ä¸ª - ï¼‰

UUID æ— æ³•è‡ªå¢


---

ç›´æ¥ä½¿ç”¨ uuid æ•°æ®ç±»å‹
```sql
CREATE TABLE users (
    id UUID DEFAULT gen_random_uuid() PRIMARY KEY,  -- é»˜è®¤ä½¿ç”¨éšæœº UUID
    name VARCHAR(100) NOT NULL
);
```
- `DEFAULT gen_random_uuid()`ï¼šæ¯æ¬¡æ’å…¥æ–°è¡Œæ—¶ï¼Œé»˜è®¤è‡ªåŠ¨ç”Ÿæˆ **UUID**ã€‚
- `PRIMARY KEY`ï¼šç”¨ä½œ **ä¸»é”®**ï¼Œç¡®ä¿å”¯ä¸€æ€§ã€‚
> âœ… **`gen_random_uuid()`** éœ€è¦ `pgcrypto` æ‰©å±•ï¼Œè¿è¡Œ `CREATE EXTENSION IF NOT EXISTS "pgcrypto";` ä»¥å¯ç”¨ã€‚


---


æ’å…¥æ•°æ®
```sql
INSERT INTO users (name) VALUES ('Alice') RETURNING id;
-- è‡ªåŠ¨ç”Ÿæˆ UUID
```

---

**UUID ç”Ÿæˆæ–¹å¼**

| æ–¹å¼                   | è¯´æ˜                    | éœ€è¦æ‰©å±•        |
| -------------------- | --------------------- | ----------- |
| `gen_random_uuid()`  | ç”Ÿæˆ **éšæœº UUIDï¼ˆæ¨èï¼‰**    | `pgcrypto`  |
| `uuid_generate_v4()` | ç”Ÿæˆ **éšæœº UUID**ï¼ˆæ ‡å‡† V4ï¼‰ | `uuid-ossp` |
| `uuid_generate_v1()` | åŸºäºæ—¶é—´æˆ³å’Œ MAC åœ°å€         | `uuid-ossp` |



--- 

**UUID vs SERIALï¼ˆè‡ªå¢ä¸»é”®ï¼‰**

| å¯¹æ¯”é¡¹      | `UUID`      | `SERIAL`ï¼ˆè‡ªå¢ï¼‰      |
| -------- | ----------- | ----------------- |
| **å”¯ä¸€æ€§**  | å…¨çƒå”¯ä¸€ï¼ˆé€‚åˆåˆ†å¸ƒå¼ï¼‰ | ä»…é™äºå•ä¸ªæ•°æ®åº“          |
| **æ€§èƒ½**   | æ’å…¥é€Ÿåº¦ç•¥æ…¢      | æ›´å¿«ï¼ˆç´¢å¼•ä¼˜åŒ–ï¼‰          |
| **å­˜å‚¨å¤§å°** | 16 å­—èŠ‚       | 4~8 å­—èŠ‚ï¼ˆBIGSERIALï¼‰ |
| **å®‰å…¨æ€§**  | ä¸å¯é¢„æµ‹ï¼Œé€‚åˆéšç§æ•°æ® | å¯çŒœæµ‹ï¼Œé€‚åˆå†…éƒ¨ ID       |

> **ğŸš€ ä»€ä¹ˆæ—¶å€™ç”¨ `UUID`ï¼Ÿ**
> 
> - åˆ†å¸ƒå¼ç³»ç»Ÿï¼ˆå¤šæœåŠ¡å™¨/å¤šæ•°æ®åº“ï¼‰
> - éœ€è¦å…¨å±€å”¯ä¸€ IDï¼ˆé˜²æ­¢ ID ç¢°æ’ï¼‰
> - ä¸èƒ½è®© ID è¢«è½»æ˜“çŒœæµ‹ï¼ˆå®‰å…¨æ€§è¦æ±‚é«˜ï¼‰



# 3 ä¸ºè¡¨idå­—æ®µè®¾ç½®ä¸»é”®è‡ªå¢


ç¬¬ä¸€æ­¥ï¼šæ–°å»º sequence
![](image/7842ba721ff29b182ce75f84d5fe49d5.png)

æˆ–è€… æ‰‹åŠ¨åˆ›å»º 
```sql
CREATE SEQUENCE IF NOT EXISTS public.kss_user_pay_id_seq
    START WITH 1  -- ä» 1 å¼€å§‹
    INCREMENT BY 1  -- æ¯æ¬¡é€’å¢ 1
    NO MINVALUE  -- æ²¡æœ‰æœ€å°å€¼é™åˆ¶
    NO MAXVALUE  -- æ²¡æœ‰æœ€å¤§å€¼é™åˆ¶
    CACHE 1;  -- ç¼“å­˜ 1 ä¸ªå€¼ï¼Œæå‡æ€§èƒ½

```



 ç¬¬äºŒæ­¥ï¼šä¸ºä¸»é”®è®¾ç½®Sequencesï¼š
 
```sql
alter table public.kss_user_pay alter column myid set default nextval('public.kss_user_pay_id_seq');
```


ç¬¬ä¸‰æ­¥ï¼šæŸ¥çœ‹æ˜¯å¦å·²ç»ç»‘å®š
![](image/96a1cf5d1e491935e2fe8bb52a91810e.png)


ç¬¬å››æ­¥
è®© myid è‡ªåŠ¨ä»åºåˆ—è·å–å€¼
å¦‚æœ myid å­—æ®µ å·²æœ‰æ•°æ®ï¼Œä½†ä¸ç¬¦åˆè‡ªå¢åºåˆ—çš„å€¼èŒƒå›´ï¼Œéœ€è¦åŒæ­¥å®ƒï¼š
`SELECT setval('public.kss_user_pay_id_seq', COALESCE((SELECT MAX(myid) FROM public.kss_user_pay), 1), false);`
è¿™æ¡ SQL è¯­å¥ä¼šå°†åºåˆ— `public.kss_user_pay_id_seq` çš„å½“å‰å€¼è®¾ä¸º `myid` åˆ—ä¸­çš„ **æœ€å¤§å€¼**ï¼Œä¿è¯ä¸ä¼šå‡ºç° **ä¸»é”®å†²çª**ã€‚


ç¬¬äº”æ­¥
ç¡®ä¿ myid ä½œä¸ºä¸»é”®
å¦‚æœ myid æ˜¯ ä¸»é”®ï¼ˆPRIMARY KEYï¼‰ï¼Œä½†ä¹‹å‰æ²¡æœ‰è®¾ç½®ï¼Œå¯ä»¥ç”¨ï¼š
```sql
ALTER TABLE public.kss_user_pay ADD CONSTRAINT kss_user_pay_pkey PRIMARY KEY (myid);

```

ç¬¬å…­æ­¥
æµ‹è¯•
è¿™é‡Œ ä¸éœ€è¦æ‰‹åŠ¨æ’å…¥ myidï¼Œå®ƒä¼šè‡ªåŠ¨ä½¿ç”¨ nextval('public.kss_user_pay_id_seq') ç”Ÿæˆæ–°å€¼ã€‚
 ```sql
 INSERT INTO public.kss_user_pay (other_column) VALUES ('some_value') RETURNING myid;
```



# 4 DDL çš„ä¾‹å­ 


```sql
CREATE TABLE public.tb_user
(
    id bigint NOT NULL,
    user_name character varying(255) COLLATE pg_catalog."default" NOT NULL,
    password character varying(255) COLLATE pg_catalog."default" NOT NULL,
    email character varying(255) COLLATE pg_catalog."default",
    phone_number bigint,
    description character varying(255) COLLATE pg_catalog."default",
    create_time timestamp(6) with time zone,
    update_time timestamp(6) with time zone,
    CONSTRAINT tb_user_pkey PRIMARY KEY (id)
)

CREATE TABLE public.tb_role
(
    id bigint NOT NULL,
    name character varying(255) COLLATE pg_catalog."default",
    role_key character varying(255) COLLATE pg_catalog."default",
    description character varying(255) COLLATE pg_catalog."default",
    create_time timestamp(6) with time zone,
    update_time timestamp(6) with time zone,
    CONSTRAINT tb_role_pkey PRIMARY KEY (id)
)

CREATE TABLE public.tb_user_role
(
    user_id bigint NOT NULL,
    role_id bigint NOT NULL
)
------
è‘—ä½œæƒå½’@pdaiæ‰€æœ‰
åŸæ–‡é“¾æ¥ï¼šhttps://pdai.tech/md/spring/springboot/springboot-x-postgre-mp.html
```


---


```sql
DROP TABLE IF EXISTS `sys_user`;
CREATE TABLE `sys_user`  (
  `id` int(0) NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®id',
  `username` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL COMMENT 'ç”¨æˆ·å',
  `nickname` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL COMMENT 'ç”¨æˆ·æ˜µç§°',
  `password` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL COMMENT 'ç”¨æˆ·å¯†ç ',
  `sex` enum('1','2') CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL COMMENT 'ç”¨æˆ·æ€§åˆ«',
  `birthday` date NULL DEFAULT NULL COMMENT 'ç”¨æˆ·ç”Ÿæ—¥',
  `email` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL COMMENT 'ç”¨æˆ·é‚®ç®±',
  `phone` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL COMMENT 'ç”¨æˆ·ç”µè¯',
  `addr` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL COMMENT 'ç”¨æˆ·åœ°å€',
  `stop_flag` enum('1','0') CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL COMMENT 'ç”¨æˆ·å¯ç”¨æ ‡å¿—',
  `create_time` datetime(0) NULL DEFAULT NULL ON UPDATE CURRENT_TIMESTAMP(0) COMMENT 'ç”¨æˆ·åˆ›å»ºæ—¶é—´',
  `update_time` datetime(0) NULL DEFAULT NULL COMMENT 'ç”¨æˆ·æ›´æ–°æ—¶é—´',
  PRIMARY KEY (`id`) USING BTREE
) ENGINE = InnoDB AUTO_INCREMENT = 3 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_general_ci ROW_FORMAT = Dynamic;
	 
INSERT INTO `sys_user` VALUES (1, 'xiezhr', 'ç¨‹åºå‘˜å°å‡¡', '12345678', '1', '1999-09-19', 'xiezhr@qq.com', '13288888888', 'äº‘å—çœæ˜†æ˜å¸‚', '0', '2023-09-04 21:08:32', NULL);
INSERT INTO `sys_user` VALUES (2, 'xiaoqi', 'ç¨‹åºå‘˜æ™“æŸ’', '123456', '1', '2020-10-04', 'xiaoqi@163.com', '13288888888', 'äº‘å—æ–‡å±±', '0', '2023-09-04 21:09:42', NULL);
INSERT INTO `sys_user` VALUES (3, 'xiaodeng', 'è´¢åŠ¡å°é‚“', '123456', '2', '2019-09-04', 'xiaodeng@qq.com', '13588888888', 'äº‘å—æ–‡å±±', '0', '2023-09-04 21:10:43', NULL);
```


# 5 æ˜ å°„åˆ°javaæ•°æ®ç±»å‹

postgres æ•°æ®ç±»å‹ æ˜ å°„åˆ° java sæ•°æ®ç±»å‹ 
character varying -> String  
timestamp without time zone -> Date  
integer -> Integer
UUID -> UUID  


## 5.1 UUID æ˜ å°„å¤„ç†


å¯¹ postgresql å¢åˆ æ”¹æŸ¥ä»£ç å’Œå¯¹mysqlçš„å¢åˆ æ”¹æŸ¥æ²¡æœ‰ä»»ä½•åŒºåˆ«ï¼Œæˆ‘ä»¬åªæ˜¯æ›´æ¢äº†æ•°æ®æºï¼Œä»£ç ä¸ç”¨åšä»»ä½•æ”¹åŠ¨(æ¯”å¦‚è¯´ä¹‹å‰æ˜¯é€šè¿‡ mybatis æ“ä½œ mysqlï¼Œç°åœ¨åªæ˜¯æŠŠ mysql æ¢æˆ postgreï¼Œä»£ç è¿˜æ˜¯ä¿æŒåŸæ¥ä¸€æ ·å³å¯)


![](image/Pasted%20image%2020250224102217.png)


![](image/583a436c8cdc0a1591ccbc5fce32e975.png)

ç„¶åä»£ç ä¸­éœ€è¦ä½¿ç”¨ `UUID.fromString` åšä¸ªè½¬æ¢ï¼Œæ¯”å¦‚ä¸‹é¢è¿™æ ·ï¼š
![](image/830abecb9315eab3799a44c841ec6805.png)


# 6 å±æ€§ 

| `CHARACTER SET utf8mb4`                                 | æŒ‡å®š **å­—ç¬¦é›†ä¸º `utf8mb4`**ï¼Œæ”¯æŒ **Emoji**                                                                                                            |
| ------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------- |
| **`COLLATE pg_catalog."default"`**<br><br>              | Specifies the **collation** (sorting and comparison rules).<br>`pg_catalog."default"` means it uses the **database's default collation**.<br> |
| `user_name VARCHAR(255) COLLATE "en_US.UTF-8" NOT NULL` | You can explicitly set a collation like `en_US.UTF-8` for **case-sensitive** or **locale-specific** sorting.                                  |
| `user_name CITEXT NOT NULL`                             | To ensure case-insensitive comparisons, use CITEXT:                                                                                           |
| `COLLATE utf8mb4_general_ci`                            | æŒ‡å®š **æ’åºè§„åˆ™**ï¼Œ**å¿½ç•¥å¤§å°å†™**                                                                                                                         |
| `NULL` or `NOT NULL`                                    | å…è®¸è¯¥å­—æ®µå€¼ **ä¸ºç©º**ï¼ˆå³ `NULL`ï¼‰                                                                                                                       |
| `DEFAULT NULL`                                          | å¦‚æœä¸æŒ‡å®šå€¼ï¼Œåˆ™ **é»˜è®¤å€¼ä¸º `NULL`**                                                                                                                      |
| `COMMENT 'ç”¨æˆ·æ˜µç§°'`                                        | ç»™è¯¥å­—æ®µåŠ ä¸Š **æ³¨é‡Š**ï¼Œæ–¹ä¾¿é˜…è¯»                                                                                                                            |


## 6.1 å­—ç¬¦é›†

åœ¨ `utf8mb4` å­—ç¬¦é›†ä¸‹ï¼Œå¸¸è§çš„ä¸¤ç§æ’åºè§„åˆ™ï¼ˆ`COLLATE`ï¼‰ï¼š

| æ’åºè§„åˆ™                 | ä½œç”¨                                    |
| -------------------- | ------------------------------------- |
| `utf8mb4_general_ci` | **æ€§èƒ½æ›´å¥½**ï¼Œä½†ä¸åŒºåˆ†æŸäº› Unicode å˜ä½“ï¼Œå¦‚ `ÃŸ = ss` |
| `utf8mb4_unicode_ci` | **æ›´åŠ å‡†ç¡®**ï¼ŒæŒ‰ç…§ Unicode è§„èŒƒæ’åºï¼Œæ¨èç”¨äºå¤šè¯­è¨€æ”¯æŒ    |
**å¦‚æœä½ çš„ç³»ç»Ÿæ¶‰åŠå¤šç§è¯­è¨€ï¼ˆå¦‚ä¸­æ–‡ã€å¾·è¯­ç­‰ï¼‰ï¼Œå»ºè®®ä½¿ç”¨ `utf8mb4_unicode_ci`**ã€‚




